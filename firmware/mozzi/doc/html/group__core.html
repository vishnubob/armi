<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Mozzi: Mozzi core definitions and functions</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  <td id="projectlogo"><img alt="Logo" src="mozzi_smooth_courier_rotated_small_flying_light.png"/></td>
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Mozzi
   &#160;<span id="projectnumber">alpha 0.01.1l</span>
   </div>
   <div id="projectbrief">sound synthesis library for Arduino</div>
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.8.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Mozzi core definitions and functions</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr class="memitem:ga4a4f0dc9e1f5947ac6b5336b5cf14d4f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga4a4f0dc9e1f5947ac6b5336b5cf14d4f">AUDIO_CHANNEL_1_PIN</a>&#160;&#160;&#160;TIMER1_A_PIN</td></tr>
<tr class="memdesc:ga4a4f0dc9e1f5947ac6b5336b5cf14d4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Digital pin 9 is the pwm audio output pin.  <a href="#ga4a4f0dc9e1f5947ac6b5336b5cf14d4f"></a><br/></td></tr>
<tr class="memitem:ga5b972bafb3267e820993812beca1b298"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga5b972bafb3267e820993812beca1b298">AUDIO_RATE</a>&#160;&#160;&#160;16384</td></tr>
<tr class="memdesc:ga5b972bafb3267e820993812beca1b298"><td class="mdescLeft">&#160;</td><td class="mdescRight">AUDIO_RATE is fixed at 16384 Hz for now.  <a href="#ga5b972bafb3267e820993812beca1b298"></a><br/></td></tr>
<tr class="memitem:gacec43f46095112fe36129fbb46ed5762"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#gacec43f46095112fe36129fbb46ed5762">AUDIO_PWM_RESOLUTION</a>&#160;&#160;&#160;488</td></tr>
<tr class="memdesc:gacec43f46095112fe36129fbb46ed5762"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the maximum sample resolution.  <a href="#gacec43f46095112fe36129fbb46ed5762"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gaedc83c89280eccc3b7fdb3115daab573"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#gaedc83c89280eccc3b7fdb3115daab573">startMozzi</a> (unsigned int control_rate_hz)</td></tr>
<tr class="memdesc:gaedc83c89280eccc3b7fdb3115daab573"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets up the timers for audio and control rate processes.  <a href="#gaedc83c89280eccc3b7fdb3115daab573"></a><br/></td></tr>
<tr class="memitem:ga2fca37b988ab369e2f3c3108c683e59d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga2fca37b988ab369e2f3c3108c683e59d">audioHook</a> ()</td></tr>
<tr class="memdesc:ga2fca37b988ab369e2f3c3108c683e59d"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is required in Arduino's loop().  <a href="#ga2fca37b988ab369e2f3c3108c683e59d"></a><br/></td></tr>
<tr class="memitem:ga59d187b915b2e366c88489e52801951a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#ga59d187b915b2e366c88489e52801951a">updateControl</a> ()</td></tr>
<tr class="memdesc:ga59d187b915b2e366c88489e52801951a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is where you put your control code.  <a href="#ga59d187b915b2e366c88489e52801951a"></a><br/></td></tr>
<tr class="memitem:gaab0d2c840c1aac4bb5f9b8ef5df30f6a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__core.html#gaab0d2c840c1aac4bb5f9b8ef5df30f6a">updateAudio</a> ()</td></tr>
<tr class="memdesc:gaab0d2c840c1aac4bb5f9b8ef5df30f6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is where you put your audio code.  <a href="#gaab0d2c840c1aac4bb5f9b8ef5df30f6a"></a><br/></td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="ga4a4f0dc9e1f5947ac6b5336b5cf14d4f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="group__core.html#ga4a4f0dc9e1f5947ac6b5336b5cf14d4f">AUDIO_CHANNEL_1_PIN</a>&#160;&#160;&#160;TIMER1_A_PIN</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Digital pin 9 is the pwm audio output pin. </p>
<p>For now there is only one channel. </p>

<p>Definition at line <a class="el" href="_mozzi_guts_8h_source.html#l00068">68</a> of file <a class="el" href="_mozzi_guts_8h_source.html">MozziGuts.h</a>.</p>

</div>
</div>
<a class="anchor" id="gacec43f46095112fe36129fbb46ed5762"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="group__core.html#gacec43f46095112fe36129fbb46ed5762">AUDIO_PWM_RESOLUTION</a>&#160;&#160;&#160;488</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This is the maximum sample resolution. </p>
<p>8 bit (ie. 256) is usually fine but there might be times where the extra headroom is useful. Use powers of two in audio calculations and use right shifts for divisions where possible. Also, in tests while writing Mozzi, shifts on byte boundaries seem to work fastest. For example, &gt;&gt; 8 is faster than &gt;&gt; 4. Test your timings where possible, using an oscilloscope. To test timing, include <a class="el" href="utils_8h_source.html">utils.h</a> in your sketch, put SET_PIN13_OUT in setup(), then SET_PIN13_HIGH and SET_PIN13_LOW around your test code (see <a href="group__util.html">Mozzi utility functions</a>). </p>

<p>Definition at line <a class="el" href="_mozzi_guts_8h_source.html#l00103">103</a> of file <a class="el" href="_mozzi_guts_8h_source.html">MozziGuts.h</a>.</p>

</div>
</div>
<a class="anchor" id="ga5b972bafb3267e820993812beca1b298"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define <a class="el" href="group__core.html#ga5b972bafb3267e820993812beca1b298">AUDIO_RATE</a>&#160;&#160;&#160;16384</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>AUDIO_RATE is fixed at 16384 Hz for now. </p>
<p>This is a compromise between the sample rate (interrupt rate) and sample bitdepth (pwm width), which are interdependent due to the way pulse wave modulation is used to generate the sound output. With the AUDIO_RATE at 16384, the sample resolution is 488, which provides some headroom above the 8bit table resolution currently used by the oscillators. You can look at the TimerOne library for more info about how interrupt rate and pwm resolution relate. </p>

<p>Definition at line <a class="el" href="_mozzi_guts_8h_source.html#l00085">85</a> of file <a class="el" href="_mozzi_guts_8h_source.html">MozziGuts.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ga2fca37b988ab369e2f3c3108c683e59d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__core.html#ga2fca37b988ab369e2f3c3108c683e59d">audioHook</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This is required in Arduino's loop(). </p>
<p>It calls <a class="el" href="group__core.html#gaab0d2c840c1aac4bb5f9b8ef5df30f6a" title="This is where you put your audio code.">updateAudio()</a> and puts the result into Mozzi's output buffer. </p>
<p>try pre-decrement positions and swap gap calc around </p>

<p>Definition at line <a class="el" href="_mozzi_guts_8cpp_source.html#l00088">88</a> of file <a class="el" href="_mozzi_guts_8cpp_source.html">MozziGuts.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="gaedc83c89280eccc3b7fdb3115daab573"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__core.html#gaedc83c89280eccc3b7fdb3115daab573">startMozzi</a> </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>control_rate_hz</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets up the timers for audio and control rate processes. </p>
<p>It goes in your sketch's setup() routine. <a class="el" href="group__core.html#gaedc83c89280eccc3b7fdb3115daab573" title="Sets up the timers for audio and control rate processes.">startMozzi()</a> starts audio interrupts on Timer 1 and control interrupts on Timer 2. The audio rate is currently fixed at 16384 Hz. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">control_rate_hz</td><td>Sets how often <a class="el" href="group__core.html#ga59d187b915b2e366c88489e52801951a" title="This is where you put your control code.">updateControl()</a> is called. It can be any power of 2 above and including 64. The practical upper limit for control rate depends on how busy the processor is, and you might need to do some tests to find the best setting. It's good to define CONTROL_RATE in your sketches (eg. "#define CONTROL_RATE 128") because the literal numeric value is necessary for Oscils to work properly, and it also helps to keep the calculations in your sketch clear. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="_mozzi_guts_8cpp_source.html#l00053">53</a> of file <a class="el" href="_mozzi_guts_8cpp_source.html">MozziGuts.cpp</a>.</p>

</div>
</div>
<a class="anchor" id="gaab0d2c840c1aac4bb5f9b8ef5df30f6a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__core.html#gaab0d2c840c1aac4bb5f9b8ef5df30f6a">updateAudio</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This is where you put your audio code. </p>
<p><a class="el" href="group__core.html#gaab0d2c840c1aac4bb5f9b8ef5df30f6a" title="This is where you put your audio code.">updateAudio()</a> has to keep up with the AUDIO_RATE of 16384 Hz, so to keep things running smoothly, avoid doing any calculations here which could be done in setup() or <a class="el" href="group__core.html#ga59d187b915b2e366c88489e52801951a" title="This is where you put your control code.">updateControl()</a>. </p>
<dl class="section return"><dt>Returns:</dt><dd>an audio sample, between -244 and 243 inclusive. </dd></dl>

</div>
</div>
<a class="anchor" id="ga59d187b915b2e366c88489e52801951a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__core.html#ga59d187b915b2e366c88489e52801951a">updateControl</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This is where you put your control code. </p>
<p>You need <a class="el" href="group__core.html#ga59d187b915b2e366c88489e52801951a" title="This is where you put your control code.">updateControl()</a> somewhere in your sketch, even if it's empty. <a class="el" href="group__core.html#ga59d187b915b2e366c88489e52801951a" title="This is where you put your control code.">updateControl()</a> is called at the control rate you set in <a class="el" href="group__core.html#gaedc83c89280eccc3b7fdb3115daab573" title="Sets up the timers for audio and control rate processes.">startMozzi()</a>. To save processor load, avoid any calculations here which could be done in setup(). </p>

</div>
</div>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu Sep 13 2012 22:32:01 for Mozzi by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.0
</small></address>

</body>
</html>
